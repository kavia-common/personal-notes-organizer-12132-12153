---
import { formatDate } from "../types";
const { note } = Astro.props as { note: { id: string; title: string; content: string; tags: string[]; updatedAt: string; createdAt: string; } };
---
<article class="note-card" data-id={note.id}>
  <h3 class="note-title">{note.title || "Untitled"}</h3>
  <div class="note-meta">
    <span>Updated {formatDate(note.updatedAt)}</span>
    {note.tags.length ? <span>â€¢</span> : null}
    {note.tags.length ? <span>{note.tags.join(", ")}</span> : null}
  </div>
  <div class="note-body">{note.content}</div>
  <div class="note-actions">
    <button class="btn secondary btn-edit" type="button">Edit</button>
    <button class="btn ghost btn-delete" type="button">Delete</button>
  </div>
</article>

<script>
  const root = document.currentScript?.closest('.note-card');
  const id = root?.getAttribute('data-id');

  root?.querySelector('.btn-edit')?.addEventListener('click', () => {
    window.dispatchEvent(new CustomEvent('open-editor', { detail: { id } }));
  });

  root?.querySelector('.btn-delete')?.addEventListener('click', () => {
    window.dispatchEvent(new CustomEvent('request-delete', { detail: { id } }));
  });
</script>
